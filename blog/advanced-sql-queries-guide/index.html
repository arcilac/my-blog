<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/my-blog/_next/static/css/83cc0ea6f102b864.css" crossorigin="" data-precedence="next"/><link rel="stylesheet" href="/my-blog/_next/static/css/a494df4e6249897d.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/my-blog/_next/static/chunks/webpack-e4b2ba0bd574cac0.js" crossorigin=""/><script src="/my-blog/_next/static/chunks/fd9d1056-8eeb8092ef3d3dd5.js" async="" crossorigin=""></script><script src="/my-blog/_next/static/chunks/938-84fed2705efa299b.js" async="" crossorigin=""></script><script src="/my-blog/_next/static/chunks/main-app-f4d94776ad940ad5.js" async="" crossorigin=""></script><script src="/my-blog/_next/static/chunks/250-f66e98452b80d3d3.js" async=""></script><script src="/my-blog/_next/static/chunks/app/layout-eeb53c07ffb10a3f.js" async=""></script><script src="/my-blog/_next/static/chunks/644-4de71cea8aeaed79.js" async=""></script><script src="/my-blog/_next/static/chunks/852-215445fe88778aae.js" async=""></script><script src="/my-blog/_next/static/chunks/app/blog/%5Bslug%5D/page-fab3f594c1476cf4.js" async=""></script><link rel="icon" href="/favicon.ico"/><title>Blog</title><meta name="description" content="A personal blog connected with Notion"/><link rel="icon" href="/my-blog/favicon.ico" type="image/x-icon" sizes="16x16"/><script src="/my-blog/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="bg-black text-white min-h-screen flex flex-col"><div class="flex flex-col min-h-screen"><header class="navbar"><div class="navbar-container"><a class="navbar-logo" href="/my-blog/">Cami&#x27;s Blog</a><nav class="navbar-nav hidden md:flex"><a class="navbar-link" href="/my-blog/">Home</a><a class="navbar-link" href="/my-blog/blog/">Blog</a><a class="navbar-link" href="https://arcilac.github.io/portfolio/">Contact</a></nav><div class="flex items-center gap-4"></div></div></header><div class="flex-grow"><main class="post-container"><article class="post-article"><h1 class="post-title">Advanced SQL Queries: Mastering Complex Database Operations</h1><div class="post-content"><div class="notion-content" style="color:var(--foreground)"><p style="margin-bottom:1rem;line-height:1.7">Now that you've mastered the basics of SQL, it's time to level up your database skills. Advanced SQL techniques allow you to handle complex business logic, optimize performance, and extract deeper insights from your data.</p><p style="margin-bottom:1rem;line-height:1.7">In this guide, we'll explore powerful SQL features that will transform you from a beginner into a proficient database developer.</p><hr style="border:none;height:1px;background-color:var(--border);margin:2rem 0"/><h2 style="font-size:1.5rem;font-weight:bold;margin-top:2rem;margin-bottom:0.75rem;padding-bottom:0.25rem">üéØ HAVING: Filtering Grouped Data</h2><p style="margin-bottom:1rem;line-height:1.7">While <code class="inline-code">WHERE</code> filters individual rows, <code class="inline-code">HAVING</code> filters groups created by <code class="inline-code">GROUP BY</code>. Think of <code class="inline-code">HAVING</code> as the "WHERE clause for aggregated data."</p><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Basic HAVING Example:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">SELECT</span><span> category</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#9cdcfe">COUNT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> product_count
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> products
</span><span></span><span class="token" style="color:#9cdcfe">GROUP</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> category
</span><span></span><span class="token" style="color:#9cdcfe">HAVING</span><span> </span><span class="token" style="color:#9cdcfe">COUNT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">&gt;</span><span> </span><span class="token" style="color:#b5cea8">5</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><p style="margin-bottom:1rem;line-height:1.7">This shows only categories with more than 5 products.</p><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">HAVING vs WHERE:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d4d4">--</span><span> ‚ùå </span><span class="token" style="color:#4ec9b0">This</span><span> won</span><span class="token" style="color:#ce9178">&#x27;t work - can&#x27;</span><span>t use aggregates </span><span class="token" style="color:#569CD6">in</span><span> </span><span class="token" style="color:#9cdcfe">WHERE</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">SELECT</span><span> category</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#9cdcfe">COUNT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> product_count
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> products
</span><span></span><span class="token" style="color:#9cdcfe">WHERE</span><span> </span><span class="token" style="color:#9cdcfe">COUNT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">&gt;</span><span> </span><span class="token" style="color:#b5cea8">5</span><span>  </span><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#9cdcfe">ERROR</span><span class="token" style="color:#d4d4d4">!</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">GROUP</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> category</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#d4d4d4">--</span><span> ‚úÖ </span><span class="token" style="color:#4ec9b0">Correct</span><span> approach </span><span class="token" style="color:#569CD6">with</span><span> </span><span class="token" style="color:#9cdcfe">HAVING</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">SELECT</span><span> category</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#9cdcfe">COUNT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> product_count
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> products
</span><span></span><span class="token" style="color:#9cdcfe">GROUP</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> category
</span><span></span><span class="token" style="color:#9cdcfe">HAVING</span><span> </span><span class="token" style="color:#9cdcfe">COUNT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">&gt;</span><span> </span><span class="token" style="color:#b5cea8">5</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Complex HAVING Example:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">SELECT</span><span>
</span><span>    user_id</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">COUNT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> order_count</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">SUM</span><span class="token" style="color:#d4d4d4">(</span><span>total_amount</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> total_spent
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> orders
</span><span></span><span class="token" style="color:#9cdcfe">WHERE</span><span> order_date </span><span class="token" style="color:#d4d4d4">&gt;=</span><span> </span><span class="token" style="color:#ce9178">&#x27;2024-01-01&#x27;</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">GROUP</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> user_id
</span><span></span><span class="token" style="color:#9cdcfe">HAVING</span><span> </span><span class="token" style="color:#9cdcfe">COUNT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">&gt;=</span><span> </span><span class="token" style="color:#b5cea8">3</span><span> </span><span class="token" style="color:#9cdcfe">AND</span><span> </span><span class="token" style="color:#9cdcfe">SUM</span><span class="token" style="color:#d4d4d4">(</span><span>total_amount</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">&gt;</span><span> </span><span class="token" style="color:#b5cea8">1000</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><p style="margin-bottom:1rem;line-height:1.7">This finds customers who placed at least 3 orders and spent more than $1000 this year.</p><hr style="border:none;height:1px;background-color:var(--border);margin:2rem 0"/><h2 style="font-size:1.5rem;font-weight:bold;margin-top:2rem;margin-bottom:0.75rem;padding-bottom:0.25rem">üîó Advanced JOIN Techniques</h2><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">LEFT JOIN with NULL Checks:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">Find</span><span> users who haven&#x27;t placed </span><span class="token" style="color:#ce9178">any</span><span> orders
</span><span></span><span class="token" style="color:#9cdcfe">SELECT</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">,</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">email</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> users u
</span><span></span><span class="token" style="color:#9cdcfe">LEFT</span><span> </span><span class="token" style="color:#9cdcfe">JOIN</span><span> orders o </span><span class="token" style="color:#9cdcfe">ON</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">user_id</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">WHERE</span><span> o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">user_id</span><span> </span><span class="token" style="color:#9cdcfe">IS</span><span> </span><span class="token" style="color:#9cdcfe">NULL</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Self JOIN:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">Find</span><span> employees and their managers
</span><span></span><span class="token" style="color:#9cdcfe">SELECT</span><span>
</span><span>    e</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span> </span><span class="token" style="color:#c586c0">as</span><span> employee_name</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    m</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span> </span><span class="token" style="color:#c586c0">as</span><span> manager_name
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> employees e
</span><span></span><span class="token" style="color:#9cdcfe">LEFT</span><span> </span><span class="token" style="color:#9cdcfe">JOIN</span><span> employees m </span><span class="token" style="color:#9cdcfe">ON</span><span> e</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">manager_id</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> m</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Multiple JOINs:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">SELECT</span><span>
</span><span>    u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">order_date</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    p</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">product_name</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    oi</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">quantity</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> users u
</span><span></span><span class="token" style="color:#9cdcfe">JOIN</span><span> orders o </span><span class="token" style="color:#9cdcfe">ON</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">user_id</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">JOIN</span><span> order_items oi </span><span class="token" style="color:#9cdcfe">ON</span><span> o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> oi</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">order_id</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">JOIN</span><span> products p </span><span class="token" style="color:#9cdcfe">ON</span><span> oi</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">product_id</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> p</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">WHERE</span><span> o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">order_date</span><span> </span><span class="token" style="color:#d4d4d4">&gt;=</span><span> </span><span class="token" style="color:#ce9178">&#x27;2024-01-01&#x27;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><hr style="border:none;height:1px;background-color:var(--border);margin:2rem 0"/><h2 style="font-size:1.5rem;font-weight:bold;margin-top:2rem;margin-bottom:0.75rem;padding-bottom:0.25rem">ü™ü Window Functions: Advanced Analytics</h2><p style="margin-bottom:1rem;line-height:1.7">Window functions perform calculations across related rows without collapsing them into groups.</p><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">ROW_NUMBER() - Ranking Data:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">SELECT</span><span>
</span><span>    name</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    salary</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    department</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">ROW_NUMBER</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#9cdcfe">OVER</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">PARTITION</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> department </span><span class="token" style="color:#9cdcfe">ORDER</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> salary </span><span class="token" style="color:#9cdcfe">DESC</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> rank_in_dept
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> employees</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">RANK() and DENSE_RANK():</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">SELECT</span><span>
</span><span>    product_name</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    sales_amount</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">RANK</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#9cdcfe">OVER</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">ORDER</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> sales_amount </span><span class="token" style="color:#9cdcfe">DESC</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> rank</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">DENSE_RANK</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#9cdcfe">OVER</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">ORDER</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> sales_amount </span><span class="token" style="color:#9cdcfe">DESC</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> dense_rank
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> product_sales</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Running Totals with SUM():</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">SELECT</span><span>
</span><span>    order_date</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    daily_revenue</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">SUM</span><span class="token" style="color:#d4d4d4">(</span><span>daily_revenue</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#9cdcfe">OVER</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">ORDER</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> order_date</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> running_total
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> daily_sales
</span><span></span><span class="token" style="color:#9cdcfe">ORDER</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> order_date</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">LAG() and LEAD() - Comparing with Previous/Next Rows:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">SELECT</span><span>
</span><span>    month</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    revenue</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">LAG</span><span class="token" style="color:#d4d4d4">(</span><span>revenue</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#9cdcfe">OVER</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">ORDER</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> month</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> previous_month</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    revenue </span><span class="token" style="color:#d4d4d4">-</span><span> </span><span class="token" style="color:#9cdcfe">LAG</span><span class="token" style="color:#d4d4d4">(</span><span>revenue</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#9cdcfe">OVER</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">ORDER</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> month</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> growth
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> monthly_revenue</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><hr style="border:none;height:1px;background-color:var(--border);margin:2rem 0"/><h2 style="font-size:1.5rem;font-weight:bold;margin-top:2rem;margin-bottom:0.75rem;padding-bottom:0.25rem">üîç Common Table Expressions (CTEs)</h2><p style="margin-bottom:1rem;line-height:1.7">CTEs make complex queries more readable by breaking them into logical parts.</p><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Basic CTE:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">WITH</span><span> high_value_customers </span><span class="token" style="color:#9cdcfe">AS</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">SELECT</span><span> user_id</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#9cdcfe">SUM</span><span class="token" style="color:#d4d4d4">(</span><span>total_amount</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> total_spent
</span><span>    </span><span class="token" style="color:#9cdcfe">FROM</span><span> orders
</span><span>    </span><span class="token" style="color:#9cdcfe">GROUP</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> user_id
</span><span>    </span><span class="token" style="color:#9cdcfe">HAVING</span><span> </span><span class="token" style="color:#9cdcfe">SUM</span><span class="token" style="color:#d4d4d4">(</span><span>total_amount</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">&gt;</span><span> </span><span class="token" style="color:#b5cea8">1000</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">SELECT</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">,</span><span> hvc</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">total_spent</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> high_value_customers hvc
</span><span></span><span class="token" style="color:#9cdcfe">JOIN</span><span> users u </span><span class="token" style="color:#9cdcfe">ON</span><span> hvc</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">user_id</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Recursive CTE - Organizational Hierarchy:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">WITH</span><span> </span><span class="token" style="color:#9cdcfe">RECURSIVE</span><span> employee_hierarchy </span><span class="token" style="color:#9cdcfe">AS</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>
</span><span>    </span><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">Base</span><span> </span><span class="token" style="color:#569CD6">case</span><span class="token" style="color:#d4d4d4">:</span><span> top</span><span class="token" style="color:#d4d4d4">-</span><span>level managers
</span><span>    </span><span class="token" style="color:#9cdcfe">SELECT</span><span> id</span><span class="token" style="color:#d4d4d4">,</span><span> name</span><span class="token" style="color:#d4d4d4">,</span><span> manager_id</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#b5cea8">1</span><span> </span><span class="token" style="color:#c586c0">as</span><span> level
</span><span>    </span><span class="token" style="color:#9cdcfe">FROM</span><span> employees
</span><span>    </span><span class="token" style="color:#9cdcfe">WHERE</span><span> manager_id </span><span class="token" style="color:#9cdcfe">IS</span><span> </span><span class="token" style="color:#9cdcfe">NULL</span><span>
</span>
<span>    </span><span class="token" style="color:#9cdcfe">UNION</span><span> </span><span class="token" style="color:#9cdcfe">ALL</span><span>
</span>
<span>    </span><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">Recursive</span><span> </span><span class="token" style="color:#569CD6">case</span><span class="token" style="color:#d4d4d4">:</span><span> employees </span><span class="token" style="color:#569CD6">with</span><span> managers
</span><span>    </span><span class="token" style="color:#9cdcfe">SELECT</span><span> e</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span class="token" style="color:#d4d4d4">,</span><span> e</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">,</span><span> e</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">manager_id</span><span class="token" style="color:#d4d4d4">,</span><span> eh</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">level</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> </span><span class="token" style="color:#b5cea8">1</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">FROM</span><span> employees e
</span><span>    </span><span class="token" style="color:#9cdcfe">JOIN</span><span> employee_hierarchy eh </span><span class="token" style="color:#9cdcfe">ON</span><span> e</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">manager_id</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> eh</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">SELECT</span><span> </span><span class="token" style="color:#d4d4d4">*</span><span> </span><span class="token" style="color:#9cdcfe">FROM</span><span> employee_hierarchy
</span><span></span><span class="token" style="color:#9cdcfe">ORDER</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> level</span><span class="token" style="color:#d4d4d4">,</span><span> name</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><hr style="border:none;height:1px;background-color:var(--border);margin:2rem 0"/><h2 style="font-size:1.5rem;font-weight:bold;margin-top:2rem;margin-bottom:0.75rem;padding-bottom:0.25rem">üé® Advanced Conditional Logic</h2><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">CASE Statements:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">SELECT</span><span>
</span><span>    name</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    age</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">CASE</span><span>
</span><span>        </span><span class="token" style="color:#9cdcfe">WHEN</span><span> age </span><span class="token" style="color:#d4d4d4">&lt;</span><span> </span><span class="token" style="color:#b5cea8">18</span><span> </span><span class="token" style="color:#9cdcfe">THEN</span><span> </span><span class="token" style="color:#ce9178">&#x27;Minor&#x27;</span><span>
</span><span>        </span><span class="token" style="color:#9cdcfe">WHEN</span><span> age </span><span class="token" style="color:#9cdcfe">BETWEEN</span><span> </span><span class="token" style="color:#b5cea8">18</span><span> </span><span class="token" style="color:#9cdcfe">AND</span><span> </span><span class="token" style="color:#b5cea8">65</span><span> </span><span class="token" style="color:#9cdcfe">THEN</span><span> </span><span class="token" style="color:#ce9178">&#x27;Adult&#x27;</span><span>
</span><span>        </span><span class="token" style="color:#9cdcfe">ELSE</span><span> </span><span class="token" style="color:#ce9178">&#x27;Senior&#x27;</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">END</span><span> </span><span class="token" style="color:#c586c0">as</span><span> age_category</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">CASE</span><span>
</span><span>        </span><span class="token" style="color:#9cdcfe">WHEN</span><span> total_orders </span><span class="token" style="color:#d4d4d4">&gt;</span><span> </span><span class="token" style="color:#b5cea8">50</span><span> </span><span class="token" style="color:#9cdcfe">THEN</span><span> </span><span class="token" style="color:#ce9178">&#x27;VIP&#x27;</span><span>
</span><span>        </span><span class="token" style="color:#9cdcfe">WHEN</span><span> total_orders </span><span class="token" style="color:#d4d4d4">&gt;</span><span> </span><span class="token" style="color:#b5cea8">20</span><span> </span><span class="token" style="color:#9cdcfe">THEN</span><span> </span><span class="token" style="color:#ce9178">&#x27;Regular&#x27;</span><span>
</span><span>        </span><span class="token" style="color:#9cdcfe">ELSE</span><span> </span><span class="token" style="color:#ce9178">&#x27;New&#x27;</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">END</span><span> </span><span class="token" style="color:#c586c0">as</span><span> customer_tier
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> user_summary</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Conditional Aggregation:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">SELECT</span><span>
</span><span>    category</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">COUNT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">*</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> total_products</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">COUNT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">CASE</span><span> </span><span class="token" style="color:#9cdcfe">WHEN</span><span> in_stock </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#569cd6">true</span><span> </span><span class="token" style="color:#9cdcfe">THEN</span><span> </span><span class="token" style="color:#b5cea8">1</span><span> </span><span class="token" style="color:#9cdcfe">END</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> in_stock_count</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">COUNT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">CASE</span><span> </span><span class="token" style="color:#9cdcfe">WHEN</span><span> price </span><span class="token" style="color:#d4d4d4">&gt;</span><span> </span><span class="token" style="color:#b5cea8">100</span><span> </span><span class="token" style="color:#9cdcfe">THEN</span><span> </span><span class="token" style="color:#b5cea8">1</span><span> </span><span class="token" style="color:#9cdcfe">END</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> premium_count</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">AVG</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">CASE</span><span> </span><span class="token" style="color:#9cdcfe">WHEN</span><span> in_stock </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#569cd6">true</span><span> </span><span class="token" style="color:#9cdcfe">THEN</span><span> price </span><span class="token" style="color:#9cdcfe">END</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> avg_in_stock_price
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> products
</span><span></span><span class="token" style="color:#9cdcfe">GROUP</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> category</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><hr style="border:none;height:1px;background-color:var(--border);margin:2rem 0"/><h2 style="font-size:1.5rem;font-weight:bold;margin-top:2rem;margin-bottom:0.75rem;padding-bottom:0.25rem">üìä Subqueries: Queries Within Queries</h2><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Correlated Subqueries:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">Find</span><span> products that are above average price </span><span class="token" style="color:#569CD6">in</span><span> their category
</span><span></span><span class="token" style="color:#9cdcfe">SELECT</span><span> product_name</span><span class="token" style="color:#d4d4d4">,</span><span> price</span><span class="token" style="color:#d4d4d4">,</span><span> category
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> products p1
</span><span></span><span class="token" style="color:#9cdcfe">WHERE</span><span> price </span><span class="token" style="color:#d4d4d4">&gt;</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">SELECT</span><span> </span><span class="token" style="color:#9cdcfe">AVG</span><span class="token" style="color:#d4d4d4">(</span><span>price</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">FROM</span><span> products p2
</span><span>    </span><span class="token" style="color:#9cdcfe">WHERE</span><span> p2</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">category</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> p1</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">category</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">EXISTS vs IN:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">Using</span><span> </span><span class="token" style="color:#9cdcfe">EXISTS</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>often more efficient</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">SELECT</span><span> name </span><span class="token" style="color:#9cdcfe">FROM</span><span> users u
</span><span></span><span class="token" style="color:#9cdcfe">WHERE</span><span> </span><span class="token" style="color:#9cdcfe">EXISTS</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">SELECT</span><span> </span><span class="token" style="color:#b5cea8">1</span><span> </span><span class="token" style="color:#9cdcfe">FROM</span><span> orders o
</span><span>    </span><span class="token" style="color:#9cdcfe">WHERE</span><span> o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">user_id</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span> </span><span class="token" style="color:#9cdcfe">AND</span><span> o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">order_date</span><span> </span><span class="token" style="color:#d4d4d4">&gt;=</span><span> </span><span class="token" style="color:#ce9178">&#x27;2024-01-01&#x27;</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">Using</span><span> </span><span class="token" style="color:#9cdcfe">IN</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">SELECT</span><span> name </span><span class="token" style="color:#9cdcfe">FROM</span><span> users
</span><span></span><span class="token" style="color:#9cdcfe">WHERE</span><span> id </span><span class="token" style="color:#9cdcfe">IN</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">SELECT</span><span> </span><span class="token" style="color:#9cdcfe">DISTINCT</span><span> user_id </span><span class="token" style="color:#9cdcfe">FROM</span><span> orders
</span><span>    </span><span class="token" style="color:#9cdcfe">WHERE</span><span> order_date </span><span class="token" style="color:#d4d4d4">&gt;=</span><span> </span><span class="token" style="color:#ce9178">&#x27;2024-01-01&#x27;</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><hr style="border:none;height:1px;background-color:var(--border);margin:2rem 0"/><h2 style="font-size:1.5rem;font-weight:bold;margin-top:2rem;margin-bottom:0.75rem;padding-bottom:0.25rem">üîß Advanced Data Manipulation</h2><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">UPSERT (INSERT ... ON CONFLICT):</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">PostgreSQL</span><span> syntax
</span><span></span><span class="token" style="color:#9cdcfe">INSERT</span><span> </span><span class="token" style="color:#9cdcfe">INTO</span><span> </span><span class="token" style="color:#dcdcaa">user_stats</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>user_id</span><span class="token" style="color:#d4d4d4">,</span><span> login_count</span><span class="token" style="color:#d4d4d4">,</span><span> last_login</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">VALUES</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#b5cea8">123</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#b5cea8">1</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#9cdcfe">NOW</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">ON</span><span> </span><span class="token" style="color:#9cdcfe">CONFLICT</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>user_id</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">DO</span><span> </span><span class="token" style="color:#9cdcfe">UPDATE</span><span> </span><span class="token" style="color:#9cdcfe">SET</span><span>
</span><span>    login_count </span><span class="token" style="color:#d4d4d4">=</span><span> user_stats</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">login_count</span><span> </span><span class="token" style="color:#d4d4d4">+</span><span> </span><span class="token" style="color:#b5cea8">1</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    last_login </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#9cdcfe">NOW</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Bulk Updates with JOINs:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">UPDATE</span><span> products
</span><span></span><span class="token" style="color:#9cdcfe">SET</span><span> discount_percentage </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">15</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">SELECT</span><span> category
</span><span>    </span><span class="token" style="color:#9cdcfe">FROM</span><span> category_performance
</span><span>    </span><span class="token" style="color:#9cdcfe">WHERE</span><span> sales_last_month </span><span class="token" style="color:#d4d4d4">&lt;</span><span> </span><span class="token" style="color:#b5cea8">1000</span><span>
</span><span></span><span class="token" style="color:#d4d4d4">)</span><span> low_performing
</span><span></span><span class="token" style="color:#9cdcfe">WHERE</span><span> products</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">category</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> low_performing</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">category</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">DELETE with JOINs:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">Delete</span><span> orders </span><span class="token" style="color:#c586c0">from</span><span> inactive users
</span><span></span><span class="token" style="color:#9cdcfe">DELETE</span><span> o </span><span class="token" style="color:#9cdcfe">FROM</span><span> orders o
</span><span></span><span class="token" style="color:#9cdcfe">JOIN</span><span> users u </span><span class="token" style="color:#9cdcfe">ON</span><span> o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">user_id</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">WHERE</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">active</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#569cd6">false</span><span> </span><span class="token" style="color:#9cdcfe">AND</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">last_login</span><span> </span><span class="token" style="color:#d4d4d4">&lt;</span><span> </span><span class="token" style="color:#ce9178">&#x27;2023-01-01&#x27;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><hr style="border:none;height:1px;background-color:var(--border);margin:2rem 0"/><h2 style="font-size:1.5rem;font-weight:bold;margin-top:2rem;margin-bottom:0.75rem;padding-bottom:0.25rem">üìà Performance Optimization Techniques</h2><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Using EXPLAIN to Analyze Queries:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">EXPLAIN</span><span> </span><span class="token" style="color:#9cdcfe">ANALYZE</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">SELECT</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#9cdcfe">COUNT</span><span class="token" style="color:#d4d4d4">(</span><span>o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> order_count
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> users u
</span><span></span><span class="token" style="color:#9cdcfe">LEFT</span><span> </span><span class="token" style="color:#9cdcfe">JOIN</span><span> orders o </span><span class="token" style="color:#9cdcfe">ON</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">user_id</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">GROUP</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span class="token" style="color:#d4d4d4">,</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">HAVING</span><span> </span><span class="token" style="color:#9cdcfe">COUNT</span><span class="token" style="color:#d4d4d4">(</span><span>o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">&gt;</span><span> </span><span class="token" style="color:#b5cea8">5</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Index Optimization:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">Create</span><span> composite index </span><span class="token" style="color:#c586c0">for</span><span> common query patterns
</span><span></span><span class="token" style="color:#9cdcfe">CREATE</span><span> </span><span class="token" style="color:#9cdcfe">INDEX</span><span> idx_orders_user_date </span><span class="token" style="color:#9cdcfe">ON</span><span> </span><span class="token" style="color:#dcdcaa">orders</span><span class="token" style="color:#d4d4d4">(</span><span>user_id</span><span class="token" style="color:#d4d4d4">,</span><span> order_date</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">Partial</span><span> index </span><span class="token" style="color:#c586c0">for</span><span> specific conditions
</span><span></span><span class="token" style="color:#9cdcfe">CREATE</span><span> </span><span class="token" style="color:#9cdcfe">INDEX</span><span> idx_active_users </span><span class="token" style="color:#9cdcfe">ON</span><span> </span><span class="token" style="color:#dcdcaa">users</span><span class="token" style="color:#d4d4d4">(</span><span>email</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#9cdcfe">WHERE</span><span> active </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#569cd6">true</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Query Hints and Optimization:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">Force</span><span> index </span><span class="token" style="color:#dcdcaa">usage</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#4ec9b0">MySQL</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">SELECT</span><span> </span><span class="token" style="color:#d4d4d4">*</span><span> </span><span class="token" style="color:#9cdcfe">FROM</span><span> users </span><span class="token" style="color:#9cdcfe">USE</span><span> </span><span class="token" style="color:#9cdcfe">INDEX</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>idx_email</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#9cdcfe">WHERE</span><span> email </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#ce9178">&#x27;user@example.com&#x27;</span><span class="token" style="color:#d4d4d4">;</span><span>
</span>
<span></span><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">Optimize</span><span> </span><span class="token" style="color:#569CD6">with</span><span> specific </span><span class="token" style="color:#9cdcfe">JOIN</span><span> order
</span><span></span><span class="token" style="color:#9cdcfe">SELECT</span><span> </span><span class="token" style="color:#6a9955">/*+ USE_NL(u o) */</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">name</span><span class="token" style="color:#d4d4d4">,</span><span> o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">total</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> users u
</span><span></span><span class="token" style="color:#9cdcfe">JOIN</span><span> orders o </span><span class="token" style="color:#9cdcfe">ON</span><span> u</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">id</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> o</span><span class="token" style="color:#d4d4d4">.</span><span class="token property-access">user_id</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><hr style="border:none;height:1px;background-color:var(--border);margin:2rem 0"/><h2 style="font-size:1.5rem;font-weight:bold;margin-top:2rem;margin-bottom:0.75rem;padding-bottom:0.25rem">üßÆ Advanced Aggregation Patterns</h2><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">ROLLUP for Subtotals:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">SELECT</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">COALESCE</span><span class="token" style="color:#d4d4d4">(</span><span>category</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">&#x27;TOTAL&#x27;</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> category</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">COALESCE</span><span class="token" style="color:#d4d4d4">(</span><span>brand</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#ce9178">&#x27;ALL BRANDS&#x27;</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> brand</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">SUM</span><span class="token" style="color:#d4d4d4">(</span><span>sales</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> total_sales
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> product_sales
</span><span></span><span class="token" style="color:#9cdcfe">GROUP</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> </span><span class="token" style="color:#9cdcfe">ROLLUP</span><span class="token" style="color:#d4d4d4">(</span><span>category</span><span class="token" style="color:#d4d4d4">,</span><span> brand</span><span class="token" style="color:#d4d4d4">)</span><span>
</span><span></span><span class="token" style="color:#9cdcfe">ORDER</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> category</span><span class="token" style="color:#d4d4d4">,</span><span> brand</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Pivot Tables with CASE:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#9cdcfe">SELECT</span><span>
</span><span>    product_id</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">SUM</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">CASE</span><span> </span><span class="token" style="color:#9cdcfe">WHEN</span><span> </span><span class="token" style="color:#9cdcfe">EXTRACT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">MONTH</span><span> </span><span class="token" style="color:#9cdcfe">FROM</span><span> sale_date</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">1</span><span> </span><span class="token" style="color:#9cdcfe">THEN</span><span> amount </span><span class="token" style="color:#9cdcfe">ELSE</span><span> </span><span class="token" style="color:#b5cea8">0</span><span> </span><span class="token" style="color:#9cdcfe">END</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> jan_sales</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">SUM</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">CASE</span><span> </span><span class="token" style="color:#9cdcfe">WHEN</span><span> </span><span class="token" style="color:#9cdcfe">EXTRACT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">MONTH</span><span> </span><span class="token" style="color:#9cdcfe">FROM</span><span> sale_date</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">2</span><span> </span><span class="token" style="color:#9cdcfe">THEN</span><span> amount </span><span class="token" style="color:#9cdcfe">ELSE</span><span> </span><span class="token" style="color:#b5cea8">0</span><span> </span><span class="token" style="color:#9cdcfe">END</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> feb_sales</span><span class="token" style="color:#d4d4d4">,</span><span>
</span><span>    </span><span class="token" style="color:#9cdcfe">SUM</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">CASE</span><span> </span><span class="token" style="color:#9cdcfe">WHEN</span><span> </span><span class="token" style="color:#9cdcfe">EXTRACT</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#9cdcfe">MONTH</span><span> </span><span class="token" style="color:#9cdcfe">FROM</span><span> sale_date</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#b5cea8">3</span><span> </span><span class="token" style="color:#9cdcfe">THEN</span><span> amount </span><span class="token" style="color:#9cdcfe">ELSE</span><span> </span><span class="token" style="color:#b5cea8">0</span><span> </span><span class="token" style="color:#9cdcfe">END</span><span class="token" style="color:#d4d4d4">)</span><span> </span><span class="token" style="color:#c586c0">as</span><span> mar_sales
</span><span></span><span class="token" style="color:#9cdcfe">FROM</span><span> sales
</span><span></span><span class="token" style="color:#9cdcfe">GROUP</span><span> </span><span class="token" style="color:#9cdcfe">BY</span><span> product_id</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><hr style="border:none;height:1px;background-color:var(--border);margin:2rem 0"/><h2 style="font-size:1.5rem;font-weight:bold;margin-top:2rem;margin-bottom:0.75rem;padding-bottom:0.25rem">üîê Advanced Security Practices</h2><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Row-Level Security:</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#d4d4d4">--</span><span> </span><span class="token" style="color:#4ec9b0">Create</span><span> policy to restrict data access
</span><span></span><span class="token" style="color:#9cdcfe">CREATE</span><span> </span><span class="token" style="color:#9cdcfe">POLICY</span><span> user_data_policy </span><span class="token" style="color:#9cdcfe">ON</span><span> orders
</span><span></span><span class="token" style="color:#9cdcfe">FOR</span><span> </span><span class="token" style="color:#9cdcfe">ALL</span><span> </span><span class="token" style="color:#9cdcfe">TO</span><span> application_role
</span><span></span><span class="token" style="color:#9cdcfe">USING</span><span> </span><span class="token" style="color:#d4d4d4">(</span><span>user_id </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#dcdcaa">current_setting</span><span class="token" style="color:#d4d4d4">(</span><span class="token" style="color:#ce9178">&#x27;app.current_user_id&#x27;</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">:</span><span class="token" style="color:#d4d4d4">:</span><span class="token" style="color:#9cdcfe">INTEGER</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><h3 style="font-size:1.25rem;font-weight:bold;margin-top:1.5rem;margin-bottom:0.75rem">Parameterized Queries (Application Level):</h3><div style="margin-bottom:1.5rem;margin-top:1.5rem"><pre style="color:#d4d4d4;font-size:0.9rem;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:1rem;margin:.5em 0;overflow:auto;background:#1e1e1e;border-radius:0.5rem;background-color:#1E1E1E"><code class="language-typescript" style="white-space:pre;color:#9cdcfe;font-size:13px;text-shadow:none;font-family:Menlo, Monaco, Consolas, &quot;Andale Mono&quot;, &quot;Ubuntu Mono&quot;, &quot;Courier New&quot;, monospace;direction:ltr;text-align:left;word-spacing:normal;word-break:normal;line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none"><span class="token" style="color:#6a9955">// Node.js example with prepared statements</span><span>
</span><span></span><span class="token" style="color:#569CD6">const</span><span> query </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token template-string template-punctuation" style="color:#ce9178">`</span><span class="token template-string" style="color:#ce9178">
</span><span class="token template-string" style="color:#ce9178">    SELECT * FROM users
</span><span class="token template-string" style="color:#ce9178">    WHERE email = $1 AND created_at &gt;= $2
</span><span class="token template-string" style="color:#ce9178"></span><span class="token template-string template-punctuation" style="color:#ce9178">`</span><span class="token" style="color:#d4d4d4">;</span><span>
</span><span></span><span class="token" style="color:#569CD6">const</span><span> result </span><span class="token" style="color:#d4d4d4">=</span><span> </span><span class="token" style="color:#c586c0">await</span><span> client</span><span class="token" style="color:#d4d4d4">.</span><span class="token method property-access" style="color:#dcdcaa">query</span><span class="token" style="color:#d4d4d4">(</span><span>query</span><span class="token" style="color:#d4d4d4">,</span><span> </span><span class="token" style="color:#d4d4d4">[</span><span>email</span><span class="token" style="color:#d4d4d4">,</span><span> startDate</span><span class="token" style="color:#d4d4d4">]</span><span class="token" style="color:#d4d4d4">)</span><span class="token" style="color:#d4d4d4">;</span><span>
</span></code></pre></div><hr style="border:none;height:1px;background-color:var(--border);margin:2rem 0"/><h2 style="font-size:1.5rem;font-weight:bold;margin-top:2rem;margin-bottom:0.75rem;padding-bottom:0.25rem">‚úÖ Advanced Best Practices Checklist</h2><p style="margin-bottom:1rem;line-height:1.7">‚úîÔ∏è <strong>Use HAVING for filtering grouped data, WHERE for individual rows</strong></p><p style="margin-bottom:1rem;line-height:1.7">‚úîÔ∏è <strong>Leverage window functions instead of self-joins when possible</strong></p><p style="margin-bottom:1rem;line-height:1.7">‚úîÔ∏è <strong>Break complex queries into CTEs for better readability</strong></p><p style="margin-bottom:1rem;line-height:1.7">‚úîÔ∏è <strong>Use EXISTS instead of IN for better performance with large datasets</strong></p><p style="margin-bottom:1rem;line-height:1.7">‚úîÔ∏è <strong>Create appropriate indexes for your query patterns</strong></p><p style="margin-bottom:1rem;line-height:1.7">‚úîÔ∏è <strong>Always use EXPLAIN to understand query execution plans</strong></p><p style="margin-bottom:1rem;line-height:1.7">‚úîÔ∏è <strong>Implement proper error handling and transaction management</strong></p><p style="margin-bottom:1rem;line-height:1.7">‚úîÔ∏è <strong>Use parameterized queries to prevent SQL injection</strong></p><hr style="border:none;height:1px;background-color:var(--border);margin:2rem 0"/><h2 style="font-size:1.5rem;font-weight:bold;margin-top:2rem;margin-bottom:0.75rem;padding-bottom:0.25rem">üß† Conclusion</h2><p style="margin-bottom:1rem;line-height:1.7">Advanced SQL techniques unlock the full power of relational databases. By mastering window functions, CTEs, complex joins, and optimization strategies, you can handle sophisticated data analysis and build more efficient applications.</p><p style="margin-bottom:1rem;line-height:1.7">Remember that with great power comes great responsibility‚Äîalways test complex queries thoroughly and consider their performance impact on production systems. The key to SQL mastery is practice and understanding when to apply each technique for maximum effectiveness.</p></div></div><div class="post-meta"><div class="post-date"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar h-4 w-4"><rect width="18" height="18" x="3" y="4" rx="2" ry="2"></rect><line x1="16" x2="16" y1="2" y2="6"></line><line x1="8" x2="8" y1="2" y2="6"></line><line x1="3" x2="21" y1="10" y2="10"></line></svg><span>May 24, 2025</span></div><div class="post-tags"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-tag h-4 w-4"><path d="M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z"></path><path d="M7 7h.01"></path></svg><div class="flex gap-2"><span class="post-tag">#<!-- -->Databases</span><span class="post-tag">#<!-- -->sql</span></div></div></div></article></main></div><footer class="footer"><div class="footer-container"><div class="footer-content md:flex-row"><div class="footer-brand md:text-left"><a class="footer-logo" href="/my-blog/">Cami&#x27;s Blog</a><p class="footer-tagline">Personal thoughts and explorations</p></div><div class="social-links"><a href="https://github.com/Arcilac" target="_blank" rel="noopener noreferrer" class="social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-github h-5 w-5"><path d="M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4"></path><path d="M9 18c-4.51 2-5-2-7-2"></path></svg><span class="sr-only">GitHub</span></a><a href="https://www.linkedin.com/in/camila-arcila-b28347279/" target="_blank" rel="noopener noreferrer" class="social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-linkedin h-5 w-5"><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect width="4" height="12" x="2" y="9"></rect><circle cx="4" cy="4" r="2"></circle></svg><span class="sr-only">LinkedIn</span></a><a href="mailto:arcilacamila08@gmail.com" class="social-link"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-mail h-5 w-5"><rect width="20" height="16" x="2" y="4" rx="2"></rect><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"></path></svg><span class="sr-only">Email</span></a></div></div><div class="footer-bottom"><p> <!-- -->Made with <span class="text-red-500">‚ù§</span> by Camila Arcila</p></div></div></footer></div><script src="/my-blog/_next/static/chunks/webpack-e4b2ba0bd574cac0.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/my-blog/_next/static/css/83cc0ea6f102b864.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:HL[\"/my-blog/_next/static/css/a494df4e6249897d.css\",\"style\",{\"crossOrigin\":\"\"}]\n"])</script><script>self.__next_f.push([1,"4:I[47690,[],\"\"]\n7:I[5613,[],\"\"]\n9:I[31778,[],\"\"]\na:I[70269,[\"250\",\"static/chunks/250-f66e98452b80d3d3.js\",\"185\",\"static/chunks/app/layout-eeb53c07ffb10a3f.js\"],\"ThemeProvider\"]\nb:I[63186,[\"250\",\"static/chunks/250-f66e98452b80d3d3.js\",\"185\",\"static/chunks/app/layout-eeb53c07ffb10a3f.js\"],\"\"]\nc:I[69148,[\"250\",\"static/chunks/250-f66e98452b80d3d3.js\",\"185\",\"static/chunks/app/layout-eeb53c07ffb10a3f.js\"],\"\"]\ne:I[48955,[],\"\"]\n8:[\"slug\",\"advanced-sql-queries-guide\",\"d\"]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/my-blog/_next/static/css/83cc0ea6f102b864.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L4\",null,{\"buildId\":\"6PJ0KbyGIdJvgwrODRBpQ\",\"assetPrefix\":\"/my-blog\",\"initialCanonicalUrl\":\"/blog/advanced-sql-queries-guide/\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"advanced-sql-queries-guide\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"advanced-sql-queries-guide\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"advanced-sql-queries-guide\",\"d\"],{\"children\":[\"__PAGE__\",{},[\"$L5\",\"$L6\",null]]},[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$8\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/my-blog/_next/static/css/a494df4e6249897d.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]]}]]},[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}]]},[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"suppressHydrationWarning\":true,\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"meta\",null,{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"link\",null,{\"rel\":\"icon\",\"href\":\"/favicon.ico\"}]]}],[\"$\",\"body\",null,{\"className\":\"bg-black text-white min-h-screen flex flex-col\",\"children\":[\"$\",\"$La\",null,{\"defaultTheme\":\"dark\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col min-h-screen\",\"children\":[[\"$\",\"$Lb\",null,{}],[\"$\",\"div\",null,{\"className\":\"flex-grow\",\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}]}],[\"$\",\"$Lc\",null,{}]]}]}]}]]}],null]],\"initialHead\":[false,\"$Ld\"],\"globalErrorComponent\":\"$e\"}]]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Blog\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"A personal blog connected with Notion\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/my-blog/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}]]\n5:null\n"])</script><script>self.__next_f.push([1,"f:I[74366,[\"644\",\"static/chunks/644-4de71cea8aeaed79.js\",\"852\",\"static/chunks/852-215445fe88778aae.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-fab3f594c1476cf4.js\"],\"NotionRenderer\"]\n"])</script><script>self.__next_f.push([1,"6:[\"$\",\"main\",null,{\"className\":\"post-container\",\"children\":[\"$\",\"article\",null,{\"className\":\"post-article\",\"children\":[null,[\"$\",\"h1\",null,{\"className\":\"post-title\",\"children\":\"Advanced SQL Queries: Mastering Complex Database Operations\"}],[\"$\",\"div\",null,{\"className\":\"post-content\",\"children\":[\"$\",\"$Lf\",null,{\"blocks\":[{\"id\":\"block-0\",\"type\":\"paragraph\",\"content\":\"Now that you've mastered the basics of SQL, it's time to level up your database skills. Advanced SQL techniques allow you to handle complex business logic, optimize performance, and extract deeper insights from your data.\",\"properties\":{}},{\"id\":\"block-1\",\"type\":\"paragraph\",\"content\":\"In this guide, we'll explore powerful SQL features that will transform you from a beginner into a proficient database developer.\",\"properties\":{}},{\"id\":\"block-2\",\"type\":\"divider\",\"content\":\"---\",\"properties\":{}},{\"id\":\"block-3\",\"type\":\"heading_2\",\"content\":\"üéØ HAVING: Filtering Grouped Data\",\"properties\":{}},{\"id\":\"block-4\",\"type\":\"paragraph\",\"content\":\"While `WHERE` filters individual rows, `HAVING` filters groups created by `GROUP BY`. Think of `HAVING` as the \\\"WHERE clause for aggregated data.\\\"\",\"properties\":{}},{\"id\":\"block-5\",\"type\":\"heading_3\",\"content\":\"Basic HAVING Example:\",\"properties\":{}},{\"id\":\"block-6\",\"type\":\"code\",\"content\":\"```sql\\n`\\nSELECT category, COUNT(*) as product_count\\nFROM products\\nGROUP BY category\\nHAVING COUNT(*) \u003e 5;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-7\",\"type\":\"paragraph\",\"content\":\"This shows only categories with more than 5 products.\",\"properties\":{}},{\"id\":\"block-8\",\"type\":\"heading_3\",\"content\":\"HAVING vs WHERE:\",\"properties\":{}},{\"id\":\"block-9\",\"type\":\"code\",\"content\":\"```sql\\n`\\n-- ‚ùå This won't work - can't use aggregates in WHERE\\nSELECT category, COUNT(*) as product_count\\nFROM products\\nWHERE COUNT(*) \u003e 5  -- ERROR!\\nGROUP BY category;\\n\\n-- ‚úÖ Correct approach with HAVING\\nSELECT category, COUNT(*) as product_count\\nFROM products\\nGROUP BY category\\nHAVING COUNT(*) \u003e 5;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-10\",\"type\":\"heading_3\",\"content\":\"Complex HAVING Example:\",\"properties\":{}},{\"id\":\"block-11\",\"type\":\"code\",\"content\":\"```sql\\n`\\nSELECT\\n    user_id,\\n    COUNT(*) as order_count,\\n    SUM(total_amount) as total_spent\\nFROM orders\\nWHERE order_date \u003e= '2024-01-01'\\nGROUP BY user_id\\nHAVING COUNT(*) \u003e= 3 AND SUM(total_amount) \u003e 1000;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-12\",\"type\":\"paragraph\",\"content\":\"This finds customers who placed at least 3 orders and spent more than $1000 this year.\",\"properties\":{}},{\"id\":\"block-13\",\"type\":\"divider\",\"content\":\"---\",\"properties\":{}},{\"id\":\"block-14\",\"type\":\"heading_2\",\"content\":\"üîó Advanced JOIN Techniques\",\"properties\":{}},{\"id\":\"block-15\",\"type\":\"heading_3\",\"content\":\"LEFT JOIN with NULL Checks:\",\"properties\":{}},{\"id\":\"block-16\",\"type\":\"code\",\"content\":\"```sql\\n`\\n-- Find users who haven't placed any orders\\nSELECT u.name, u.email\\nFROM users u\\nLEFT JOIN orders o ON u.id = o.user_id\\nWHERE o.user_id IS NULL;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-17\",\"type\":\"heading_3\",\"content\":\"Self JOIN:\",\"properties\":{}},{\"id\":\"block-18\",\"type\":\"code\",\"content\":\"```sql\\n`\\n-- Find employees and their managers\\nSELECT\\n    e.name as employee_name,\\n    m.name as manager_name\\nFROM employees e\\nLEFT JOIN employees m ON e.manager_id = m.id;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-19\",\"type\":\"heading_3\",\"content\":\"Multiple JOINs:\",\"properties\":{}},{\"id\":\"block-20\",\"type\":\"code\",\"content\":\"```sql\\n`\\nSELECT\\n    u.name,\\n    o.order_date,\\n    p.product_name,\\n    oi.quantity\\nFROM users u\\nJOIN orders o ON u.id = o.user_id\\nJOIN order_items oi ON o.id = oi.order_id\\nJOIN products p ON oi.product_id = p.id\\nWHERE o.order_date \u003e= '2024-01-01';\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-21\",\"type\":\"divider\",\"content\":\"---\",\"properties\":{}},{\"id\":\"block-22\",\"type\":\"heading_2\",\"content\":\"ü™ü Window Functions: Advanced Analytics\",\"properties\":{}},{\"id\":\"block-23\",\"type\":\"paragraph\",\"content\":\"Window functions perform calculations across related rows without collapsing them into groups.\",\"properties\":{}},{\"id\":\"block-24\",\"type\":\"heading_3\",\"content\":\"ROW_NUMBER() - Ranking Data:\",\"properties\":{}},{\"id\":\"block-25\",\"type\":\"code\",\"content\":\"```sql\\n`\\nSELECT\\n    name,\\n    salary,\\n    department,\\n    ROW_NUMBER() OVER (PARTITION BY department ORDER BY salary DESC) as rank_in_dept\\nFROM employees;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-26\",\"type\":\"heading_3\",\"content\":\"RANK() and DENSE_RANK():\",\"properties\":{}},{\"id\":\"block-27\",\"type\":\"code\",\"content\":\"```sql\\n`\\nSELECT\\n    product_name,\\n    sales_amount,\\n    RANK() OVER (ORDER BY sales_amount DESC) as rank,\\n    DENSE_RANK() OVER (ORDER BY sales_amount DESC) as dense_rank\\nFROM product_sales;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-28\",\"type\":\"heading_3\",\"content\":\"Running Totals with SUM():\",\"properties\":{}},{\"id\":\"block-29\",\"type\":\"code\",\"content\":\"```sql\\n`\\nSELECT\\n    order_date,\\n    daily_revenue,\\n    SUM(daily_revenue) OVER (ORDER BY order_date) as running_total\\nFROM daily_sales\\nORDER BY order_date;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-30\",\"type\":\"heading_3\",\"content\":\"LAG() and LEAD() - Comparing with Previous/Next Rows:\",\"properties\":{}},{\"id\":\"block-31\",\"type\":\"code\",\"content\":\"```sql\\n`\\nSELECT\\n    month,\\n    revenue,\\n    LAG(revenue) OVER (ORDER BY month) as previous_month,\\n    revenue - LAG(revenue) OVER (ORDER BY month) as growth\\nFROM monthly_revenue;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-32\",\"type\":\"divider\",\"content\":\"---\",\"properties\":{}},{\"id\":\"block-33\",\"type\":\"heading_2\",\"content\":\"üîç Common Table Expressions (CTEs)\",\"properties\":{}},{\"id\":\"block-34\",\"type\":\"paragraph\",\"content\":\"CTEs make complex queries more readable by breaking them into logical parts.\",\"properties\":{}},{\"id\":\"block-35\",\"type\":\"heading_3\",\"content\":\"Basic CTE:\",\"properties\":{}},{\"id\":\"block-36\",\"type\":\"code\",\"content\":\"```sql\\n`\\nWITH high_value_customers AS (\\n    SELECT user_id, SUM(total_amount) as total_spent\\n    FROM orders\\n    GROUP BY user_id\\n    HAVING SUM(total_amount) \u003e 1000\\n)\\nSELECT u.name, hvc.total_spent\\nFROM high_value_customers hvc\\nJOIN users u ON hvc.user_id = u.id;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-37\",\"type\":\"heading_3\",\"content\":\"Recursive CTE - Organizational Hierarchy:\",\"properties\":{}},{\"id\":\"block-38\",\"type\":\"code\",\"content\":\"```sql\\n`\\nWITH RECURSIVE employee_hierarchy AS (\\n    -- Base case: top-level managers\\n    SELECT id, name, manager_id, 1 as level\\n    FROM employees\\n    WHERE manager_id IS NULL\\n\\n    UNION ALL\\n\\n    -- Recursive case: employees with managers\\n    SELECT e.id, e.name, e.manager_id, eh.level + 1\\n    FROM employees e\\n    JOIN employee_hierarchy eh ON e.manager_id = eh.id\\n)\\nSELECT * FROM employee_hierarchy\\nORDER BY level, name;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-39\",\"type\":\"divider\",\"content\":\"---\",\"properties\":{}},{\"id\":\"block-40\",\"type\":\"heading_2\",\"content\":\"üé® Advanced Conditional Logic\",\"properties\":{}},{\"id\":\"block-41\",\"type\":\"heading_3\",\"content\":\"CASE Statements:\",\"properties\":{}},{\"id\":\"block-42\",\"type\":\"code\",\"content\":\"```sql\\n`\\nSELECT\\n    name,\\n    age,\\n    CASE\\n        WHEN age \u003c 18 THEN 'Minor'\\n        WHEN age BETWEEN 18 AND 65 THEN 'Adult'\\n        ELSE 'Senior'\\n    END as age_category,\\n    CASE\\n        WHEN total_orders \u003e 50 THEN 'VIP'\\n        WHEN total_orders \u003e 20 THEN 'Regular'\\n        ELSE 'New'\\n    END as customer_tier\\nFROM user_summary;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-43\",\"type\":\"heading_3\",\"content\":\"Conditional Aggregation:\",\"properties\":{}},{\"id\":\"block-44\",\"type\":\"code\",\"content\":\"```sql\\n`\\nSELECT\\n    category,\\n    COUNT(*) as total_products,\\n    COUNT(CASE WHEN in_stock = true THEN 1 END) as in_stock_count,\\n    COUNT(CASE WHEN price \u003e 100 THEN 1 END) as premium_count,\\n    AVG(CASE WHEN in_stock = true THEN price END) as avg_in_stock_price\\nFROM products\\nGROUP BY category;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-45\",\"type\":\"divider\",\"content\":\"---\",\"properties\":{}},{\"id\":\"block-46\",\"type\":\"heading_2\",\"content\":\"üìä Subqueries: Queries Within Queries\",\"properties\":{}},{\"id\":\"block-47\",\"type\":\"heading_3\",\"content\":\"Correlated Subqueries:\",\"properties\":{}},{\"id\":\"block-48\",\"type\":\"code\",\"content\":\"```sql\\n`\\n-- Find products that are above average price in their category\\nSELECT product_name, price, category\\nFROM products p1\\nWHERE price \u003e (\\n    SELECT AVG(price)\\n    FROM products p2\\n    WHERE p2.category = p1.category\\n);\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-49\",\"type\":\"heading_3\",\"content\":\"EXISTS vs IN:\",\"properties\":{}},{\"id\":\"block-50\",\"type\":\"code\",\"content\":\"```sql\\n`\\n-- Using EXISTS (often more efficient)\\nSELECT name FROM users u\\nWHERE EXISTS (\\n    SELECT 1 FROM orders o\\n    WHERE o.user_id = u.id AND o.order_date \u003e= '2024-01-01'\\n);\\n\\n-- Using IN\\nSELECT name FROM users\\nWHERE id IN (\\n    SELECT DISTINCT user_id FROM orders\\n    WHERE order_date \u003e= '2024-01-01'\\n);\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-51\",\"type\":\"divider\",\"content\":\"---\",\"properties\":{}},{\"id\":\"block-52\",\"type\":\"heading_2\",\"content\":\"üîß Advanced Data Manipulation\",\"properties\":{}},{\"id\":\"block-53\",\"type\":\"heading_3\",\"content\":\"UPSERT (INSERT ... ON CONFLICT):\",\"properties\":{}},{\"id\":\"block-54\",\"type\":\"code\",\"content\":\"```sql\\n`\\n-- PostgreSQL syntax\\nINSERT INTO user_stats (user_id, login_count, last_login)\\nVALUES (123, 1, NOW())\\nON CONFLICT (user_id)\\nDO UPDATE SET\\n    login_count = user_stats.login_count + 1,\\n    last_login = NOW();\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-55\",\"type\":\"heading_3\",\"content\":\"Bulk Updates with JOINs:\",\"properties\":{}},{\"id\":\"block-56\",\"type\":\"code\",\"content\":\"```sql\\n`\\nUPDATE products\\nSET discount_percentage = 15\\nFROM (\\n    SELECT category\\n    FROM category_performance\\n    WHERE sales_last_month \u003c 1000\\n) low_performing\\nWHERE products.category = low_performing.category;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-57\",\"type\":\"heading_3\",\"content\":\"DELETE with JOINs:\",\"properties\":{}},{\"id\":\"block-58\",\"type\":\"code\",\"content\":\"```sql\\n`\\n-- Delete orders from inactive users\\nDELETE o FROM orders o\\nJOIN users u ON o.user_id = u.id\\nWHERE u.active = false AND u.last_login \u003c '2023-01-01';\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-59\",\"type\":\"divider\",\"content\":\"---\",\"properties\":{}},{\"id\":\"block-60\",\"type\":\"heading_2\",\"content\":\"üìà Performance Optimization Techniques\",\"properties\":{}},{\"id\":\"block-61\",\"type\":\"heading_3\",\"content\":\"Using EXPLAIN to Analyze Queries:\",\"properties\":{}},{\"id\":\"block-62\",\"type\":\"code\",\"content\":\"```sql\\n`\\nEXPLAIN ANALYZE\\nSELECT u.name, COUNT(o.id) as order_count\\nFROM users u\\nLEFT JOIN orders o ON u.id = o.user_id\\nGROUP BY u.id, u.name\\nHAVING COUNT(o.id) \u003e 5;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-63\",\"type\":\"heading_3\",\"content\":\"Index Optimization:\",\"properties\":{}},{\"id\":\"block-64\",\"type\":\"code\",\"content\":\"```sql\\n`\\n-- Create composite index for common query patterns\\nCREATE INDEX idx_orders_user_date ON orders(user_id, order_date);\\n\\n-- Partial index for specific conditions\\nCREATE INDEX idx_active_users ON users(email) WHERE active = true;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-65\",\"type\":\"heading_3\",\"content\":\"Query Hints and Optimization:\",\"properties\":{}},{\"id\":\"block-66\",\"type\":\"code\",\"content\":\"```sql\\n`\\n-- Force index usage (MySQL)\\nSELECT * FROM users USE INDEX (idx_email) WHERE email = 'user@example.com';\\n\\n-- Optimize with specific JOIN order\\nSELECT /*+ USE_NL(u o) */ u.name, o.total\\nFROM users u\\nJOIN orders o ON u.id = o.user_id;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-67\",\"type\":\"divider\",\"content\":\"---\",\"properties\":{}},{\"id\":\"block-68\",\"type\":\"heading_2\",\"content\":\"üßÆ Advanced Aggregation Patterns\",\"properties\":{}},{\"id\":\"block-69\",\"type\":\"heading_3\",\"content\":\"ROLLUP for Subtotals:\",\"properties\":{}},{\"id\":\"block-70\",\"type\":\"code\",\"content\":\"```sql\\n`\\nSELECT\\n    COALESCE(category, 'TOTAL') as category,\\n    COALESCE(brand, 'ALL BRANDS') as brand,\\n    SUM(sales) as total_sales\\nFROM product_sales\\nGROUP BY ROLLUP(category, brand)\\nORDER BY category, brand;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-71\",\"type\":\"heading_3\",\"content\":\"Pivot Tables with CASE:\",\"properties\":{}},{\"id\":\"block-72\",\"type\":\"code\",\"content\":\"```sql\\n`\\nSELECT\\n    product_id,\\n    SUM(CASE WHEN EXTRACT(MONTH FROM sale_date) = 1 THEN amount ELSE 0 END) as jan_sales,\\n    SUM(CASE WHEN EXTRACT(MONTH FROM sale_date) = 2 THEN amount ELSE 0 END) as feb_sales,\\n    SUM(CASE WHEN EXTRACT(MONTH FROM sale_date) = 3 THEN amount ELSE 0 END) as mar_sales\\nFROM sales\\nGROUP BY product_id;\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-73\",\"type\":\"divider\",\"content\":\"---\",\"properties\":{}},{\"id\":\"block-74\",\"type\":\"heading_2\",\"content\":\"üîê Advanced Security Practices\",\"properties\":{}},{\"id\":\"block-75\",\"type\":\"heading_3\",\"content\":\"Row-Level Security:\",\"properties\":{}},{\"id\":\"block-76\",\"type\":\"code\",\"content\":\"```sql\\n`\\n-- Create policy to restrict data access\\nCREATE POLICY user_data_policy ON orders\\nFOR ALL TO application_role\\nUSING (user_id = current_setting('app.current_user_id')::INTEGER);\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-77\",\"type\":\"heading_3\",\"content\":\"Parameterized Queries (Application Level):\",\"properties\":{}},{\"id\":\"block-78\",\"type\":\"code\",\"content\":\"```javascript\\n`\\n// Node.js example with prepared statements\\nconst query = `\\n    SELECT * FROM users\\n    WHERE email = $1 AND created_at \u003e= $2\\n`;\\nconst result = await client.query(query, [email, startDate]);\\n`\\n```\",\"properties\":{\"language\":\"$undefined\"}},{\"id\":\"block-79\",\"type\":\"divider\",\"content\":\"---\",\"properties\":{}},{\"id\":\"block-80\",\"type\":\"heading_2\",\"content\":\"‚úÖ Advanced Best Practices Checklist\",\"properties\":{}},{\"id\":\"block-81\",\"type\":\"paragraph\",\"content\":\"‚úîÔ∏è **Use HAVING for filtering grouped data, WHERE for individual rows**\",\"properties\":{}},{\"id\":\"block-82\",\"type\":\"paragraph\",\"content\":\"‚úîÔ∏è **Leverage window functions instead of self-joins when possible**\",\"properties\":{}},{\"id\":\"block-83\",\"type\":\"paragraph\",\"content\":\"‚úîÔ∏è **Break complex queries into CTEs for better readability**\",\"properties\":{}},{\"id\":\"block-84\",\"type\":\"paragraph\",\"content\":\"‚úîÔ∏è **Use EXISTS instead of IN for better performance with large datasets**\",\"properties\":{}},{\"id\":\"block-85\",\"type\":\"paragraph\",\"content\":\"‚úîÔ∏è **Create appropriate indexes for your query patterns**\",\"properties\":{}},{\"id\":\"block-86\",\"type\":\"paragraph\",\"content\":\"‚úîÔ∏è **Always use EXPLAIN to understand query execution plans**\",\"properties\":{}},{\"id\":\"block-87\",\"type\":\"paragraph\",\"content\":\"‚úîÔ∏è **Implement proper error handling and transaction management**\",\"properties\":{}},{\"id\":\"block-88\",\"type\":\"paragraph\",\"content\":\"‚úîÔ∏è **Use parameterized queries to prevent SQL injection**\",\"properties\":{}},{\"id\":\"block-89\",\"type\":\"divider\",\"content\":\"---\",\"properties\":{}},{\"id\":\"block-90\",\"type\":\"heading_2\",\"content\":\"üß† Conclusion\",\"properties\":{}},{\"id\":\"block-91\",\"type\":\"paragraph\",\"content\":\"Advanced SQL techniques unlock the full power of relational databases. By mastering window functions, CTEs, complex joins, and optimization strategies, you can handle sophisticated data analysis and build more efficient applications.\",\"properties\":{}},{\"id\":\"block-92\",\"type\":\"paragraph\",\"content\":\"Remember that with great power comes great responsibility‚Äîalways test complex queries thoroughly and consider their performance impact on production systems. The key to SQL mastery is practice and understanding when to apply each technique for maximum effectiveness.\",\"properties\":{}}]}]}],[\"$\",\"div\",null,{\"className\":\"post-meta\",\"children\":[[\"$\",\"div\",null,{\"className\":\"post-date\",\"children\":[[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-calendar h-4 w-4\",\"children\":[[\"$\",\"rect\",\"eu3xkr\",{\"width\":\"18\",\"height\":\"18\",\"x\":\"3\",\"y\":\"4\",\"rx\":\"2\",\"ry\":\"2\"}],[\"$\",\"line\",\"m3sa8f\",{\"x1\":\"16\",\"x2\":\"16\",\"y1\":\"2\",\"y2\":\"6\"}],[\"$\",\"line\",\"18kwsl\",{\"x1\":\"8\",\"x2\":\"8\",\"y1\":\"2\",\"y2\":\"6\"}],[\"$\",\"line\",\"xt86sb\",{\"x1\":\"3\",\"x2\":\"21\",\"y1\":\"10\",\"y2\":\"10\"}],\"$undefined\"]}],[\"$\",\"span\",null,{\"children\":\"May 24, 2025\"}]]}],[\"$\",\"div\",null,{\"className\":\"post-tags\",\"children\":[[\"$\",\"svg\",null,{\"xmlns\":\"http://www.w3.org/2000/svg\",\"width\":24,\"height\":24,\"viewBox\":\"0 0 24 24\",\"fill\":\"none\",\"stroke\":\"currentColor\",\"strokeWidth\":2,\"strokeLinecap\":\"round\",\"strokeLinejoin\":\"round\",\"className\":\"lucide lucide-tag h-4 w-4\",\"children\":[[\"$\",\"path\",\"14b2ls\",{\"d\":\"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z\"}],[\"$\",\"path\",\"7u93v4\",{\"d\":\"M7 7h.01\"}],\"$undefined\"]}],[\"$\",\"div\",null,{\"className\":\"flex gap-2\",\"children\":[[\"$\",\"span\",\"Databases\",{\"className\":\"post-tag\",\"children\":[\"#\",\"Databases\"]}],[\"$\",\"span\",\"sql\",{\"className\":\"post-tag\",\"children\":[\"#\",\"sql\"]}]]}]]}]]}]]}]}]\n"])</script><script>self.__next_f.push([1,""])</script></body></html>